!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(function(){try{return require("angular")}catch(e){}}()):"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?exports["jsnlog-angular"]=t(function(){try{return require("angular")}catch(e){}}()):e["jsnlog-angular"]=t(e.angular)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(){var e;try{e=n(2)}catch(t){}if(!e)try{e=window.JL}catch(t){}if(!e)throw new Error("JSNlog must be loaded!");this.$get=[function(){return e}]}function o(e,t){return e?t&&t.angular?l.angular+"."+e:t&&t.client?l.client+"."+e:l.base+"."+e:t&&t.angular?l.angular:t&&t.client?l.client:l.base}function i(){this.$get=["JL",function(e){}]}function s(e){return function(t,n){throw e(o(null,{angular:!0})).fatalException(n,t),t}}var u;try{u=n(1)}catch(f){}if(!u)try{u=window.angular}catch(f){}if(!u)throw new Error("angular must be loaded!");var a=u.module("ngJSNlog",[]);a.provider("JL",r);var l={base:"ng",client:"ng.client",angular:"ng.framework"};a.provider("Logger",i),s.$inject=["JL"],a.factory("$exceptionHandler",s),e.exports=a},function(t,n,r){if("undefined"==typeof e){var o=new Error('Cannot find module "angular"');throw o.code="MODULE_NOT_FOUND",o}t.exports=e},function(e,t,n){function r(e){if(!e)return r.__;Array.prototype.reduce||(Array.prototype.reduce=function(e,t){for(var n=t,r=0;r<this.length;r++)n=e(n,this[r],r,this);return n});var t="";return("."+e).split(".").reduce(function(e,n,o,i){return t=t?t+("."+n):n,n=e["__"+t],void 0===n&&(r.Logger.prototype=e,n=new r.Logger(t),e["__"+t]=n),n},r.__)}var o=this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n};!function(e){function t(e,t,n){void 0!==t[e]&&(null===t[e]?delete n[e]:n[e]=t[e])}function n(t){if(null!=e.enabled&&!e.enabled||null!=e.maxMessages&&1>e.maxMessages)return!1;try{if(t.userAgentRegex&&!RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(n){}try{if(t.ipRegex&&e.clientIP&&!RegExp(t.ipRegex).test(e.clientIP))return!1}catch(r){}return!0}function r(e,t){try{if(e.disallow&&RegExp(e.disallow).test(t))return!1}catch(n){}return!0}function i(e){return"function"==typeof e?e instanceof RegExp?e.toString():e():e}function s(e){switch(e=i(e),typeof e){case"string":return new u(e,null,e);case"number":return e=e.toString(),new u(e,null,e);case"boolean":return e=e.toString(),new u(e,null,e);case"undefined":return new u("undefined",null,"undefined");case"object":return e instanceof RegExp||e instanceof String||e instanceof Number||e instanceof Boolean?(e=e.toString(),new u(e,null,e)):new u(null,e,JSON.stringify(e));default:return new u("unknown",null,"unknown")}}e.enabled,e.maxMessages,e.defaultAjaxUrl,e.clientIP,e.defaultBeforeSend,e.requestId="";var u=function(){return function(e,t,n){this.msg=e,this.meta=t,this.finalString=n}}();e.setOptions=function(e){return t("enabled",e,this),t("maxMessages",e,this),t("defaultAjaxUrl",e,this),t("clientIP",e,this),t("requestId",e,this),t("defaultBeforeSend",e,this),this},e.getAllLevel=function(){return-2147483648},e.getTraceLevel=function(){return 1e3},e.getDebugLevel=function(){return 2e3},e.getInfoLevel=function(){return 3e3},e.getWarnLevel=function(){return 4e3},e.getErrorLevel=function(){return 5e3},e.getFatalLevel=function(){return 6e3},e.getOffLevel=function(){return 2147483647};var f=function(){return function(e,t){this.inner=t,this.name="JL.Exception",this.message=s(e).finalString}}();e.Exception=f,f.prototype=Error();var a=function(){return function(e,t,n,r){this.l=e,this.m=t,this.n=n,this.t=r}}();e.LogItem=a,f=function(){function o(t,n){this.appenderName=t,this.sendLogItems=n,this.level=e.getTraceLevel(),this.sendWithBufferLevel=2147483647,this.storeInBufferLevel=-2147483648,this.bufferSize=0,this.batchSize=1,this.buffer=[],this.batchBuffer=[]}return o.prototype.setOptions=function(e){return t("level",e,this),t("ipRegex",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("sendWithBufferLevel",e,this),t("storeInBufferLevel",e,this),t("bufferSize",e,this),t("batchSize",e,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this},o.prototype.log=function(e,t,o,i,s,u,f){!n(this)||!r(this,u)||s<this.storeInBufferLevel||(e=new a(s,u,f,(new Date).getTime()),s<this.level?0<this.bufferSize&&(this.buffer.push(e),this.buffer.length>this.bufferSize&&this.buffer.shift()):(s<this.sendWithBufferLevel||!this.buffer.length||(this.batchBuffer=this.batchBuffer.concat(this.buffer),this.buffer.length=0),this.batchBuffer.push(e),this.batchBuffer.length>=this.batchSize&&this.sendBatch()))},o.prototype.sendBatch=function(){0==this.batchBuffer.length||null!=e.maxMessages&&1>e.maxMessages||(null!=e.maxMessages&&(e.maxMessages-=this.batchBuffer.length),this.sendLogItems(this.batchBuffer),this.batchBuffer.length=0)},o}(),e.Appender=f;var l=function(n){function r(e){n.call(this,e,r.prototype.sendLogItemsAjax)}return o(r,n),r.prototype.setOptions=function(e){return t("url",e,this),t("beforeSend",e,this),n.prototype.setOptions.call(this,e),this},r.prototype.sendLogItemsAjax=function(t){try{var n="/jsnlog.logger";null!=e.defaultAjaxUrl&&(n=e.defaultAjaxUrl),this.url&&(n=this.url);var r=JSON.stringify({r:e.requestId,lg:t}),o=this.getXhr(n);"function"==typeof this.beforeSend?this.beforeSend(o):"function"==typeof e.defaultBeforeSend&&e.defaultBeforeSend(o),o.send(r)}catch(i){}},r.prototype.getXhr=function(t){var n=new XMLHttpRequest;return"withCredentials"in n||"undefined"==typeof XDomainRequest?(n.open("POST",t),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("JSNLog-RequestId",e.requestId),n):(n=new XDomainRequest,n.open("POST",t),n)},r}(f);e.AjaxAppender=l;var c=function(t){function n(e){t.call(this,e,n.prototype.sendLogItemsConsole)}return o(n,t),n.prototype.clog=function(e){console.log(e)},n.prototype.cerror=function(e){console.error?console.error(e):this.clog(e)},n.prototype.cwarn=function(e){console.warn?console.warn(e):this.clog(e)},n.prototype.cinfo=function(e){console.info?console.info(e):this.clog(e)},n.prototype.cdebug=function(e){console.debug?console.debug(e):this.cinfo(e)},n.prototype.sendLogItemsConsole=function(t){try{if(console){var n;for(n=0;n<t.length;++n){var r=t[n],o=r.n+": "+r.m;"undefined"==typeof window&&(o=new Date(r.t)+" | "+o),r.l<=e.getDebugLevel()?this.cdebug(o):r.l<=e.getInfoLevel()?this.cinfo(o):r.l<=e.getWarnLevel()?this.cwarn(o):this.cerror(o)}}}catch(i){}},n}(f);e.ConsoleAppender=c,f=function(){function e(e){this.loggerName=e,this.seenRegexes=[]}return e.prototype.setOptions=function(e){return t("level",e,this),t("userAgentRegex",e,this),t("disallow",e,this),t("ipRegex",e,this),t("appenders",e,this),t("onceOnly",e,this),this.seenRegexes=[],this},e.prototype.buildExceptionObject=function(e){var t={};return e.stack?t.stack=e.stack:t.e=e,e.message&&(t.message=e.message),e.name&&(t.name=e.name),e.data&&(t.data=e.data),e.inner&&(t.inner=this.buildExceptionObject(e.inner)),t},e.prototype.log=function(e,t,o){var u=0;if(!this.appenders)return this;if(e>=this.level&&n(this)&&(o?(u=this.buildExceptionObject(o),u.logData=i(t)):u=t,t=s(u),r(this,t.finalString))){if(this.onceOnly)for(u=this.onceOnly.length-1;u>=0;){if(RegExp(this.onceOnly[u]).test(t.finalString)){if(this.seenRegexes[u])return this;this.seenRegexes[u]=!0}u--}for(t.meta=t.meta||{},t.meta.loggerName=this.loggerName,u=this.appenders.length-1;u>=0;)this.appenders[u].log(1e3>=e?"trace":2e3>=e?"debug":3e3>=e?"info":4e3>=e?"warn":5e3>=e?"error":"fatal",t.msg,t.meta,function(){},e,t.finalString,this.loggerName),u--}return this},e.prototype.trace=function(e){return this.log(1e3,e)},e.prototype.debug=function(e){return this.log(2e3,e)},e.prototype.info=function(e){return this.log(3e3,e)},e.prototype.warn=function(e){return this.log(4e3,e)},e.prototype.error=function(e){return this.log(5e3,e)},e.prototype.fatal=function(e){return this.log(6e3,e)},e.prototype.fatalException=function(e,t){return this.log(6e3,e,t)},e}(),e.Logger=f,e.createAjaxAppender=function(e){return new l(e)},e.createConsoleAppender=function(e){return new c(e)},f=new l(""),"undefined"==typeof window&&(f=new c("")),e.__=new e.Logger(""),e.__.setOptions({level:e.getDebugLevel(),appenders:[f]})}(r||(r={}));var t;"undefined"!=typeof t&&(t.JL=r);var i;"function"==typeof i&&i.amd&&i("jsnlog",[],function(){return r}),"function"==typeof __jsnlog_configure&&__jsnlog_configure(r)}])});
//# sourceMappingURL=jsnlog-angular.min.js.map